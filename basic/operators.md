# 运算符

2020-05-12
@author Jiawei Mao
***

## 数学运算符

| Operator | Description    |
| -------- | -------------- |
| +        | addition       |
| -        | subtraction    |
| *        | multiplication |
| /        | division       |
| ^ or **  | 乘方           |
| %/%      | 整除           |
| %%       | 余数           |
| %*%      | 矩阵内积       |
| %o%      | 矩阵外积       |

```R
> die <- 1:6
> die
[1] 1 2 3 4 5 6
> die - 1
[1] 0 1 2 3 4 5
> die / 2
[1] 0.5 1.0 1.5 2.0 2.5 3.0
> die * die
[1]  1  4  9 16 25 36
```

可以发现：

- R 不是使用矩阵操作，可以**逐元素**执行操作。
- 在一个操作中使用多个向量时，R 会将这些向量对齐，然后逐个进行操作。
- 如果两个向量不一样长，R 会重复较短的向量，直到与长向量一样长，该行为称为**向量循环**（vector recycling）
  - 当长向量长度不能整除短向量长度，抛出警告信息

例如：

```R
> 1:2
[1] 1 2
> 1:4
[1] 1 2 3 4
> die + 1:2
[1] 2 4 4 6 6 8
> die + 1:4
[1] 2 4 6 8 6 8
警告信息:
In die + 1:4 : 长的对象长度不是短的对象长度的整倍数
```

矩阵操作：

```r
> die %*% die
     [,1]
[1,]   91
> die %o% die
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    1    2    3    4    5    6
[2,]    2    4    6    8   10   12
[3,]    3    6    9   12   15   18
[4,]    4    8   12   16   20   24
[5,]    5   10   15   20   25   30
[6,]    6   12   18   24   30   36
```

## 逻辑运算符

| Operator  | Description                      |
| --------- | -------------------------------- |
| <         | 小于                             |
| <=        | 小于等于                         |
| >         | greater than                     |
| >=        | greater than or equal to         |
| ==        | exactly equal to                 |
| !=        | not equal to                     |
| %in%      | 属于                             |
| xor(x, y) | 异或，有缺失值参与运算时为缺失值 |
| &         | 与                               |
| `|`       | 或                               |
| `!`       | 非                               |
| &&        | 短路与，仅对标量                 |
| `||`      | 短路或，仅对标量                 |

逻辑向量与逻辑标量之间，以及逻辑向量逻辑向量之间的逻辑运算，遵循一般R向量间运算规则。

在右运算符缺失时，如果左运算符能够确定真假，则可以得到非 NA 结果。例如：

```r
> TRUE | NA
[1] TRUE
> FALSE | NA
[1] NA
```

不能确定结果时返回 `NA`，例如：

```r
> TRUE & NA
[1] NA
> FALSE | NA
[1] NA
```

`%in%` 是比较特殊的比较， `x %in% y` 将 y 看作集合，判断 x 中的元素是否在 y 中。例如：

```r
> c(1, 3) %in% c(2, 3, 4)
[1] FALSE  TRUE
> c(NA, 3) %in% c(2, 3, 4)
[1] FALSE  TRUE
> c(1, 3) %in% c(NA, 3, 4)
[1] FALSE  TRUE
> c(NA, 3) %in% c(NA, 3, 4)
[1] TRUE TRUE
```

`match(x, y)` 功能和 `x %in% y` 类似，不过不是判断是否在，而是找到 `x` 的元素在 `y` 中**首次**出现的位置。例如：

```r
> match(c(1, 3), c(2, 3, 4, 3))
[1] NA  2
```

如果没有找到，返回 `NA`。

## 数据类型

R 支持多种数据类型，包括标量、向量（数值、字符、逻辑）、矩阵、数据框以及列表等。

## 赋值和下划线

R 的赋值运算符为 `<-`。例如：

```r
e <- m*c^2
```

也可以反过来：
