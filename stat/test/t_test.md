# t 检验

- [t 检验](#t-检验)
  - [简介](#简介)
  - [单样本 t 检验](#单样本-t-检验)
  - [双样本 t 检验](#双样本-t-检验)
    - [独立双样本 t 检验](#独立双样本-t-检验)
    - [配对双样本 t 检验](#配对双样本-t-检验)

***

## 简介

t 检验是用 t 分布来推测差异发生的概率，从而比较两个平均数的差异是否显著的统计学方法。

如接受新药治疗的患者的康复情况是否比使用传统药物的患者更好？杂合作物的产量是否比传统作物的产量高？

**样本特征：**

- 样本量不大
- 总体方差未知

**功能：**

- 检验数据差异
- 单样本测试，检验总体均值是否为 NULL 假设中指定的值
- 双样本测试，检验两个总体的均值是否相同

学生 t 分布，根据小样本**估计**呈正态分布且方差未知的**总体的均值**。如果方差已知(例如样本数量足够多时)，则应该用正态分布来估计总体均值。

它是对两个样本均值差异进行显著性检验的 t-test 的基础。t-test 改进了 z-test，因为 z-test 要求总体标准差已知。虽然在样本数量大时 (超过30)，可以使用 z-test 来求得近似值，但 z-test 用在小样本时会产生很大的误差，因此必须改用 t-test。

在总体标准差未知时，无论样本数量大或小皆可以使用 t-test.在待比较数据有三组以上时，因为误差无法压低，此时可以使用 ANOVA 代替 t-test.

## 单样本 t 检验

单样本检验指检验一个样本均值和总体期望的差异是否明显，判断该样本是否来自该总体。

**例 1**：传统作物的平均产量为 2400 kg/亩，现将传统作物改良以提升产量,改良后的作物称为孟山都作物，抽样调查孟山都作物的产量为 2531 kg/亩、2659 kg/亩、2487 kg/亩、2398 kg/亩、2771 kg/亩，问孟山都作物的产量是否高于传统作物?

用 R 的 `t.test()` 解决该问题：

```r
> t.test(x = c(2531, 2659, 2487, 2398, 2771), mu = 2400, alternative = "greater")

	One Sample t-test

data:  c(2531, 2659, 2487, 2398, 2771)
t = 2.5756, df = 4, p-value = 0.03081
alternative hypothesis: true mean is greater than 2400
95 percent confidence interval:
 2429.151      Inf
sample estimates:
mean of x 
   2569.2 
```

这里采用单边检验，备择假设是“孟山都作物产量高于传统作物”，t 检验返回的结果 p 值为 0.03081，结论是拒绝零假设 (p-value 0.05)，接受备择假设，表明孟山都作物的产量要高于传统作物。

在本例中,如果使用双边检验，备择假设是“孟山都作物产量不等于传统作物”，t 检验得到的 p 值为0.06 (p-value>0.05)，不能拒绝零假设，没有足够证据表孟山都作物的产量与传统作物产量有统计学显著差异。在数据分析实践中,要根据具体情况和已有信息选择单边检验还是双边检验。

## 双样本 t 检验

双样本 t 检验通过两个样本的均值差异来检验其各自所代表的总体均值的差异是否显著，根据两组样本是否独立可分为独立双样本 t 检验和配对双样本 t 检验。

### 独立双样本 t 检验

**例2：** 科学家对传统农作物进行两个不同方向的突变以提高农作物产量，突变 A 的产量抽样结果为 2405、2378、2254、2471、2390；突变 B 的产量抽样结果为 2531、2659、2487、2398、2771 (单位均为 kg/亩)，请问突变 A 和突变 B 导致作物产量的差异是否显著？

突变 A 和突变 B 产生的两组数据毫无相关性,因此这两组样本称为独立样本。两个独立样本对应的总体平均值差异是否显著这一问题也可以通过 `t.test()` 函数解决。

```r
> t.test(x = c(2405, 2378, 2254, 2471, 2390), y = c(2531, 2659, 2487, 2398, 2771), alternative = "two.sided")

	Welch Two Sample t-test

data:  c(2405, 2378, 2254, 2471, 2390) and c(2531, 2659, 2487, 2398, 2771)
t = -2.5428, df = 6.1295, p-value = 0.04311
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -371.123009   -8.076991
sample estimates:
mean of x mean of y 
   2379.6    2569.2 
```

检验结果得到 p 值为 0.043，拒绝“突变 A 的农作物和突变 B 的农作物产量不存在差异” 的零假设(p-value< 0.05)。即两者存在闲书差异。

### 配对双样本 t 检验

当样本与样本之间存在成对的相关性，要探究样本对应的总体均值的差异需要用配对双样本 t 检验。

例如,糖尿病患者治疗前和治疗后的血糖含量可视为一对成对样本，配对双样本对应的总体均值的差异也可以通过 `t.test()` 函数，调用格式同独立双样本 t 检验只需添加参数 `paired=TRUE` 即可。

